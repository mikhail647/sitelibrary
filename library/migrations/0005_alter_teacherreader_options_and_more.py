# Generated by Django 5.2 on 2025-04-16 06:58

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0004_bookrequest'),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='teacherreader',
            options={'verbose_name': 'Читатель-преподаватель/сотрудник', 'verbose_name_plural': 'Читатели-преподаватели/сотрудники'},
        ),
        migrations.RemoveField(
            model_name='studentreader',
            name='faculty_name',
        ),
        migrations.RemoveField(
            model_name='studentreader',
            name='group_number',
        ),
        migrations.RemoveField(
            model_name='teacherreader',
            name='department_name',
        ),
        migrations.AddField(
            model_name='bookcopy',
            name='cost',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Стоимость (руб.)'),
        ),
        migrations.AddField(
            model_name='interlibraryrequest',
            name='notes',
            field=models.TextField(blank=True, null=True, verbose_name='Примечания читателя'),
        ),
        migrations.AddField(
            model_name='interlibraryrequest',
            name='processed_by',
            field=models.ForeignKey(blank=True, limit_choices_to={'role__in': ['staff', 'admin']}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='processed_interlibrary_requests', to=settings.AUTH_USER_MODEL, verbose_name='Обработал сотрудник'),
        ),
        migrations.AddField(
            model_name='interlibraryrequest',
            name='processed_date',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Дата обработки'),
        ),
        migrations.AddField(
            model_name='interlibraryrequest',
            name='required_by_date',
            field=models.DateField(blank=True, null=True, verbose_name='Требуется к дате'),
        ),
        migrations.AddField(
            model_name='interlibraryrequest',
            name='staff_notes',
            field=models.TextField(blank=True, null=True, verbose_name='Примечания сотрудника'),
        ),
        migrations.AddField(
            model_name='libraryfine',
            name='notes',
            field=models.TextField(blank=True, null=True, verbose_name='Примечания'),
        ),
        migrations.AddField(
            model_name='libraryreader',
            name='can_take_books_home',
            field=models.BooleanField(default=True, verbose_name='Разрешено брать книги на дом'),
        ),
        migrations.AddField(
            model_name='studentreader',
            name='faculty',
            field=models.CharField(blank=True, max_length=100, null=True, verbose_name='Факультет'),
        ),
        migrations.AddField(
            model_name='studentreader',
            name='study_group',
            field=models.CharField(blank=True, max_length=20, null=True, verbose_name='Группа'),
        ),
        migrations.AddField(
            model_name='teacherreader',
            name='department',
            field=models.CharField(blank=True, max_length=100, null=True, verbose_name='Кафедра/Отдел'),
        ),
        migrations.AddField(
            model_name='teacherreader',
            name='position',
            field=models.CharField(blank=True, max_length=100, null=True, verbose_name='Должность'),
        ),
        migrations.AlterField(
            model_name='bookcopy',
            name='book',
            field=models.ForeignKey(db_column='book_id', on_delete=django.db.models.deletion.CASCADE, related_name='copies', to='library.bookcatalog', verbose_name='Книга (каталог)'),
        ),
        migrations.AlterField(
            model_name='bookcopy',
            name='copy_status',
            field=models.CharField(choices=[('available', 'Доступен'), ('issued', 'Выдан'), ('lost', 'Утерян'), ('damaged', 'Поврежден'), ('written_off', 'Списан')], default='available', max_length=15, verbose_name='Статус'),
        ),
        migrations.AlterField(
            model_name='bookcopy',
            name='inventory_number',
            field=models.CharField(max_length=50, unique=True, verbose_name='Инв. номер'),
        ),
        migrations.AlterField(
            model_name='bookcopy',
            name='location',
            field=models.ForeignKey(db_column='location_id', on_delete=django.db.models.deletion.PROTECT, to='library.librarylocation', verbose_name='Пункт выдачи'),
        ),
        migrations.AlterField(
            model_name='interlibraryrequest',
            name='book',
            field=models.ForeignKey(db_column='book_id', on_delete=django.db.models.deletion.CASCADE, to='library.bookcatalog', verbose_name='Книга'),
        ),
        migrations.AlterField(
            model_name='interlibraryrequest',
            name='reader',
            field=models.ForeignKey(db_column='reader_id', on_delete=django.db.models.deletion.CASCADE, to='library.libraryreader', verbose_name='Читатель'),
        ),
        migrations.AlterField(
            model_name='interlibraryrequest',
            name='request_date',
            field=models.DateField(default=django.utils.timezone.now, verbose_name='Дата запроса'),
        ),
        migrations.AlterField(
            model_name='interlibraryrequest',
            name='request_status',
            field=models.CharField(choices=[('pending', 'Ожидает'), ('approved', 'Одобрен'), ('rejected', 'Отклонен'), ('processing', 'В обработке (заказан/отправлен)'), ('received', 'Получен (в библиотеке)'), ('issued', 'Выдан читателю'), ('returned', 'Возвращен (читателем)'), ('closed', 'Закрыт (возвращен поставщику)')], default='pending', max_length=15, verbose_name='Статус запроса'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='fine_amount',
            field=models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Сумма штрафа'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='fine_date',
            field=models.DateField(default=django.utils.timezone.now, verbose_name='Дата штрафа'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='fine_reason',
            field=models.CharField(choices=[('overdue', 'Просрочка возврата'), ('lost', 'Утеря книги'), ('damaged', 'Повреждение книги')], max_length=10, verbose_name='Причина штрафа'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='fine_status',
            field=models.CharField(choices=[('pending', 'Ожидает оплаты'), ('paid', 'Оплачен'), ('cancelled', 'Списан')], default='pending', max_length=10, verbose_name='Статус штрафа'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='loan',
            field=models.ForeignKey(blank=True, db_column='loan_id', null=True, on_delete=django.db.models.deletion.SET_NULL, to='library.bookloan', verbose_name='Выдача (если применимо)'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='reader',
            field=models.ForeignKey(db_column='reader_id', on_delete=django.db.models.deletion.PROTECT, to='library.libraryreader', verbose_name='Читатель'),
        ),
        migrations.AlterField(
            model_name='libraryfine',
            name='request',
            field=models.ForeignKey(blank=True, db_column='request_id', null=True, on_delete=django.db.models.deletion.PROTECT, to='library.interlibraryrequest', verbose_name='Запрос МБА (если применимо)'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='first_name',
            field=models.CharField(max_length=50, verbose_name='Имя'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='last_name',
            field=models.CharField(max_length=50, verbose_name='Фамилия'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='library_card_number',
            field=models.CharField(max_length=20, unique=True, verbose_name='Номер чит. билета'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='middle_name',
            field=models.CharField(blank=True, max_length=50, null=True, verbose_name='Отчество'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='reader_status',
            field=models.CharField(choices=[('active', 'Активен'), ('suspended', 'Приостановлен'), ('inactive', 'Неактивен')], default='active', max_length=10, verbose_name='Статус'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='reader_type',
            field=models.ForeignKey(db_column='reader_type_id', on_delete=django.db.models.deletion.PROTECT, to='library.readertype', verbose_name='Тип читателя'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='registration_date',
            field=models.DateField(verbose_name='Дата регистрации'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='suspension_end_date',
            field=models.DateField(blank=True, null=True, verbose_name='Дата окончания приостановки'),
        ),
        migrations.AlterField(
            model_name='libraryreader',
            name='user',
            field=models.ForeignKey(blank=True, db_column='user_id', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='library_profile', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AlterField(
            model_name='studentreader',
            name='course_number',
            field=models.IntegerField(blank=True, null=True, verbose_name='Курс'),
        ),
        migrations.AlterField(
            model_name='studentreader',
            name='reader',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, related_name='student_profile', serialize=False, to='library.libraryreader'),
        ),
        migrations.AlterField(
            model_name='teacherreader',
            name='academic_degree',
            field=models.CharField(blank=True, max_length=50, null=True, verbose_name='Ученая степень'),
        ),
        migrations.AlterField(
            model_name='teacherreader',
            name='academic_title',
            field=models.CharField(blank=True, max_length=50, null=True, verbose_name='Ученое звание'),
        ),
        migrations.AlterField(
            model_name='teacherreader',
            name='reader',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, related_name='teacher_profile', serialize=False, to='library.libraryreader'),
        ),
        migrations.DeleteModel(
            name='StaffReader',
        ),
    ]
